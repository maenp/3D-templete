(function(){
"use strict";function getUrlParam(o){var e=new RegExp("(^|&)"+o+"=([^&]*)(&|$)"),i=window.location.search.substr(1).match(e);return null!=i?decodeURIComponent(i[2]):null}function loadWebViewBridge(){function o(o){if(WebViewJavascriptBridge._messageHandler)throw new Error("WebViewJavascriptBridge.init called twice");WebViewJavascriptBridge._messageHandler=o;var e=m;m=null;for(var i=0;i<e.length;i++)c(e[i])}function e(o,e){t({data:o},e)}function i(o,e){d[o]=e}function n(o,e,i){t({handlerName:o,data:e},i)}function t(o,e){if(e){var i="cb_"+b+++"_"+(new Date).getTime();p[i]=e,o.callbackId=i}l.push(o),s.src=u+"://"+f}function r(){var o=JSON.stringify(l);return l=[],o}function c(o){setTimeout(function(){var e,i=JSON.parse(o);if(i.responseId){if(!(e=p[i.responseId]))return;e(i.responseData),delete p[i.responseId]}else{if(i.callbackId){var n=i.callbackId;e=function(o){t({responseId:n,responseData:o})}}var r=WebViewJavascriptBridge._messageHandler;i.handlerName&&(r=d[i.handlerName]);try{r(i.data,e)}catch(o){"undefined"!=typeof console&&console.log("WebViewJavascriptBridge: WARNING: javascript handler threw.",i,o)}}})}function a(o){m?m.push(o):c(o)}if(!window.WebViewJavascriptBridge){var s,l=[],m=[],d={},u="wvjbscheme",f="__WVJB_QUEUE_MESSAGE__",p={},b=1;window.WebViewJavascriptBridge={init:o,send:e,registerHandler:i,callHandler:n,_fetchQueue:r,_handleMessageFromObjC:a};var _=document;!function(o){s=o.createElement("iframe"),s.style.display="none",s.src=u+"://"+f,o.documentElement.appendChild(s)}(_),o(function(o){this.log("ios initial")})}}function compare(o){if(is_o_webview)return 1;var e,i=typeof o;if("string"==i||"number"==i)e=o+"";else{if("object"!=i)return void console.log("不支持的版本号");e=o[platform]}var n=momo_version.split("."),t=e.toString().split("."),r=Math.max(t.length,n.length);try{for(var c=0;c<r;c++){var a=isFinite(n[c])&&Number(n[c])||0,s=isFinite(t[c])&&Number(t[c])||0;if(a<s)return-1;if(a>s)return 1}}catch(o){return-1}return 0}function checkMK(){if(is_android){if(/momoKit/.test(ua))return!0}else if(is_ios){if(compare("8.11.3")>=0&&window.navigator&&void 0!==window.navigator.isMK)return!!window.navigator.isMK;if(build_version>=451||is_o_webview){if(/momoKit/.test(ua))return!0}else if(compare("6.5")>=0&&location.href.indexOf("_bid")>-1)return!0}return!1}function initAppObj(o){if(o.hasOwnProperty("apps")){var e=core.is_mk?"apps":"games",i=o.apps,n={};n[e]={};for(var t in i){var r="url_"+core.platform;n[e][t]={schema:i[t].schema,url:i[t][r]||"",param:i[t].param||{}}}return n}}var bridgeVersion="5.3.7",lastModified="Fri Aug 28 2020 16:01:34 GMT+0800 (GMT+08:00)";window.mm&&console.error("Do not initialize bridge more than once");var ua=window.navigator.userAgent,is_m_webview=/momoWebView/.test(ua),is_o_webview=/(molive|momoGame)WebView/.test(ua),is_webview=is_m_webview||is_o_webview,is_ios=/iP(ad|hone|od)/.test(ua),is_android=/[aA]ndroid/.test(ua),is_wp=/Windows Phone/.test(ua),is_mobile=/Mobile/.test(ua),is_pc=!is_mobile,is_unknown=!is_android&&!is_ios&&!is_wp,is_weixin=/MicroMessenger/.test(ua),is_hasNet=/netType\/(\d)/.exec(ua),is_wifi=!(!is_webview||!is_hasNet)&&"1"==is_hasNet[1],version=/momoWebView\/?(\d+)\.(\d+)\.?(\d)?/.exec(ua)||["","0","0"],momo_main_version=parseInt(version[1]),momo_minor_version=parseInt(version[2]),momo_version=version[1]+"."+version[2]+(version[3]?"."+version[3]:""),arr_build_version=/(ios|android)\/(\d+)/i.exec(ua),build_version=arr_build_version?arr_build_version[2]:0,platform=is_ios?"ios":is_android?"android":is_wp?"win_phone":"unknown",debug=0,query={},is_offline=1==getUrlParam("_offline");try{location.search.substr(1).split("&").forEach(function(o){o.split("=")[0]in query?query[o.split("=")[0]].push(o.split("=")[1]):query[o.split("=")[0]]=[o.split("=")[1]]})}catch(o){}var prepare={_native_obj:null,_adapter:null,NOOP:function(){},init:function(){if(is_webview)switch(platform){case"ios":loadWebViewBridge(),this._native_obj=window.WebViewJavascriptBridge,this._adapter=this.iOSAdapter();break;case"android":window.aobj&&(this._native_obj=window.aobj,this._adapter=this.AndroidAdapter());break;case"win_phone":this._adapter=this.WpAdapter();break;default:this._adapter=this.MoAdapter()}else this._adapter=this.MoAdapter()},initMK:function(){this._adapter=is_ios?this.iOS_MK_Adapter():is_android?this.Android_MK_Adapter():this.MoAdapter()},MoAdapter:function(){return{name:"basic",invoke:function(){}}},iOSAdapter:function(){return{name:"ios",_NAME:{init:"handleStateInfo",closeWindow:"close",callShare:"showGeneralShare"},_CB:{readImage:"momo_btn_controller_setImageSrc"},invoke:function(){var args=Array.prototype.slice.apply(arguments);try{var _adp=this._adapter,__handler,__callback,__cbk;void 0===args[1]&&(args[1]="{}"),args.push(this.NOOP);var _orig=args[0];args[0]=_adp._NAME.hasOwnProperty(args[0])?_adp._NAME[args[0]]:args[0];var _obj="string"==typeof args[1]?JSON.parse(args[1]):args[1];if("init"==_orig){if(_obj.hasOwnProperty("ui_btn"))for(var i=0;i<_obj.ui_btn.buttons.length;i++)_obj.ui_btn.buttons[i].param.callback&&(__callback=_obj.ui_btn.buttons[i].param.callback,this._native_obj.registerHandler(__callback.replace(/\./g,"_"),function(data){try{var cbk=eval(__callback);cbk&&"function"==typeof cbk&&cbk.call(null,data)}catch(o){}}.bind(this)))}else"callShare"==_orig||"shareOne"==_orig?(__callback=_obj.hasOwnProperty("callback")?_obj.callback:null,__handler=__callback.replace(/\./g,"_")):(__callback=_obj.hasOwnProperty("callback")?_obj.callback:null,__handler=_adp._CB.hasOwnProperty(_orig)?_adp._CB[_orig]:"",__handler=""==__handler?"momo_bridge_"+_orig:__handler);__callback&&__handler&&this._native_obj.registerHandler(__handler,function(data){try{var cbk=eval(__callback);cbk&&"function"==typeof cbk&&("readImage"==_orig?cbk.call(null,data.id,data.data,data.size,data.type):cbk.call(null,data))}catch(o){}}.bind(this)),this._native_obj.callHandler.apply(null,args)}catch(o){}}}},AndroidAdapter:function(){return{name:"android",invoke:function(){var o=Array.prototype.slice.apply(arguments),e=o.shift();if(this._native_obj[e]&&"function"==typeof this._native_obj[e])try{o[0]?this._native_obj[e](o[0]):this._native_obj[e]()}catch(o){}}}},WpAdapter:function(){return{name:"win phone",invoke:function(){var o=Array.prototype.slice.apply(arguments),e=o.shift();try{window.external.notify('{"'+e+'": '+o+"}")}catch(o){}}}},mkURL:function(o,e,i){return o=o||"",e=e||"",i=i||"{}","mkjsbridge://"+o+"/"+e+"?param="+encodeURIComponent(i)},iOS_MK_Adapter:function(){function o(o){var e=document.createElement("iframe");e.style.display="none",e.src=o,document.documentElement.appendChild(e);var i=mm.__RETURN_VALUE;return mm.__RETURN_VALUE=void 0,e.parentNode.removeChild(e),i}var e=this;return{name:"ios",invoke:function(i,n,t){window["momokit_"+i];o(e.mkURL(i,n,t))}}},Android_MK_Adapter:function(o){var e=this;return window.mkAobj?{name:"android",invoke:function(o,e,i){o=o||"",e=e||"",i=i||"{}",window.mkAobj.bridgejs(o,e,i)}}:{name:"android aobj",invoke:function(o,i,n){window.prompt(e.mkURL(o,i,n))}}}},mm={version:bridgeVersion,last_modified:lastModified,is_webview:is_webview,is_o_webview:is_o_webview,momo_version:momo_version,momo_main_version:momo_main_version,momo_minor_version:momo_minor_version,build_version:build_version,is_wifi:is_wifi,is_weixin:is_weixin,ua:ua,query:query,platform:platform,_callbacks:{},is_mk:checkMK(),is_offline:is_offline,_uniqueId:1,_ctxId:-1,bid:null==getUrlParam("_bid")?"":parseInt(getUrlParam("_bid")),NoneCallback:function(){},build:function(o){if(o.hasOwnProperty("common")&&(o.ios=o.common,o.android=o.common),o.hasOwnProperty(platform)){var e=o[platform];if(is_m_webview&&(o.need_mk&&!mm.is_mk||o.version&&compare(o.version)<0)){var i=e[e.length-1];if(i&&"function"==typeof i)return void i({status:"-99",message:"当前版本不支持此功能，请检查升级"})}mm.is_mk?this.invoke.apply(this,e):(e.shift(),this.invoke.apply(this,e))}},invoke:function(o,e,i,n){if("string"!=typeof e&&(n=i,i=e,e=o,o=null),"function"==typeof i&&(n=i,i={}),i)try{var t="string"==typeof i?JSON.parse(i):i;i.callback&&"function"==typeof i.callback&&(t.callback=this.createCallback(e,i.callback)),n&&"function"==typeof n&&void 0===t.callback&&(t.callback=this.createCallback(e,n)),i=JSON.stringify(t)}catch(o){return}var r=mm.is_mk?[o,e,i]:[e,i];prepare._adapter.invoke.apply(prepare,r)},createCallback:function(o,e){var i="__BRIDGE_CALLBACK__"+this._uniqueId+++"_"+(new Date).getTime();return this._callbacks.hasOwnProperty(o)||(this._callbacks[o]={}),this._callbacks[o][i]=function(){var i=Array.prototype.slice.apply(arguments);if("getItem"!=o)for(var n=0;n<i.length;n++)try{i[n]=JSON.parse(i[n])}catch(o){}e.apply(null,i)},"mm._callbacks."+o+"."+i},fireDocumentEvent:function(o,e,i,n){var t;if("bridgeEvent"==o&&(e="be:"+e),t=document.createEvent("Events"),t.initEvent(e,!1,!1),t.name=e,i)try{t.data=JSON.parse(i)}catch(o){t.data=i}n&&(t.origin=n),document.dispatchEvent(t)},compare:compare,protocol:"file:"==location.protocol?"http:":location.protocol,host:function(){if("file:"==location.protocol){var o=location.pathname,e=/[oO]ffline\/\d+\/(.*\.com)/;if(e.exec(o))return e.exec(o)[1]}return location.host}(),pathname:function(){if("file:"==location.protocol){var o=location.pathname,e=/[oO]ffline\/\d+\/.*\.com(\/.*)/;if(e.exec(o))return e.exec(o)[1]}return location.pathname}(),ready:function(o){return/complete|loaded|interactive/.test(document.readyState)&&document.body?o.call(null,this):document.addEventListener("DOMContentLoaded",function(){o.call(null,this)}.bind(this),!1),this}};mm.is_mk?prepare.initMK():(prepare.init(),momo_version<5.6&&(window.momo_btn_controller||(window.momo_btn_controller={setImageSrc:function(o,e,i,n){if(!e)return!1;document.getElementById(o).src="data:image/jpeg;base64,"+e}})));var core=mm;core.init=function(){core.ui.setUIBtn()};var hasRefreshed=!0;core.ui={setBackBtn:function(o){core.build({common:["ui","setBackBtn",{},o]})},setDialogBackBtn:function(o){core.build({common:["ui","setDialogBackBtn",{},o]})},openUrl:function(o){var e=o.url,i=core.compare("6.11")<0;if(3==o.target)return i?(location.href="momochat://immomo.com?goto="+encodeURIComponent(e),!1):(core.ui.openGoto({param:e}),!1);if(!core.is_webview)return setTimeout(function(){window.location.href=e},20),!1;if(/^momochat/.test(e)){if(i)return location.href=e,!1;var n=new RegExp("(^|&)goto=([^&]*)(&|$)"),t=e.indexOf("?"),r=e.indexOf("?")>=0?e.substring(t+1).match(n):null;return null!=r?core.ui.openGoto({param:decodeURIComponent(r[2])}):console.warn("openUrl参数出错"),!1}var c=/^http/.test(e);if(!c){var a=e.indexOf("#"),s=a>-1?e.substring(a):"";e=e.replace(s,"");var l=e.indexOf("?"),m=l>-1?e.substring(l):"";if(core.is_mk&&-1==m.indexOf("_bid=")&&""!==core.bid&&(e+=-1==e.indexOf("?")?"?":"&",e+="_bid="+core.bid),o.target>0){if(!/^\//.test(e)){var d=core.pathname.lastIndexOf("/");if(d>0){var u=core.pathname.substring(d+1);e=core.pathname.replace(u,"")+e}else e="/"+e}e=core.protocol+"//"+core.host+e}e+=s,o.url=e}switch(o.target){case 0:return!c&&/^\//.test(e)&&(e=core.protocol+"//"+core.host+e),window.location.href=e,!1;case 1:if(o.pass&&(o.url="https://passport.immomo.com/authorize?redirect_uri="+encodeURIComponent(o.url)),i)return void(location.href="momochat://immomo.com?goto=[momo|url|"+encodeURIComponent(o.url)+"]");if(!core.is_mk)return void core.build({common:["ui","directGoto",{param:"[momo|url|"+o.url+"]"}]});break;case 2:if(!core.is_mk)return core.build({common:["ui","openExternalBrowser",{url:o.url}]}),!1}core.build({common:["ui","openUrl",o]})},openGoto:function(o){var e=o.param;core.is_mk&&"ios"==core.platform?core.build({common:["ui","openGoto",{goto:e}]}):core.build({common:["ui","directGoto",{param:e}]})},openLinkInExternalBrowser:function(o){var e=core.is_mk?"openLinkInExternalBrowser":"openExternalBrowser";core.build({common:["ui",e,o]})},goBack:function(o){core.build({common:["ui","goBack",o]})},reload:function(o){core.is_mk?core.build({common:["ui","reload",o]}):location.reload()},close:function(o){if(/momoPopup/.test(navigator.userAgent))return void core.ui.closePopup(o);var e=core.is_mk?"close":"closeWindow";"ios"==core.platform&&core.compare("6.5.19")<0&&(o={}),"android"==core.platform&&core.compare("6.5.2")<0&&(o=null),core.build({common:["ui",e,o]})},closePopup:function(o){core.build({common:["ui","closePopup",o]})},showNavBar:function(){var o=core.is_mk?"showNavBar":"showTitleBar";core.build({common:["ui",o,{}]})},hideNavBar:function(){var o=core.is_mk?"hideNavBar":"hideTitleBar";core.build({common:["ui",o,{}]})},postMessage:function(o){/^bn/.test(o.name)||o.target||(o.target="*"),core.build({common:["ui","postMessage",o]})},showKeyboard:function(o){core.build({common:["ui","showKeyboard",o]})},showMessage:function(o){core.build({common:["ui","showMessage",o]})},showConfirm:function(o){var e=function(e){if(e){switch(e.button){case 0:o.cancel&&o.cancel();break;case 1:o.callback1&&o.callback1();break;case 2:o.callback2&&o.callback2()}o.finish&&o.finish(e)}};core.build({common:["ui","showConfirm",o,e]})},setUI:function(o){var e=core.is_mk?"setUI":"setTitleBarUI";core.build({common:["ui",e,o],version:{ios:"6.5.1",android:"6.5.1"}})},setTitle:function(o){o&&o.title&&(document.title=o.title),core.build({common:["ui","setTitle",o]})},setPulldown:function(o){core.build({common:["ui","setPulldown",o]})},setUIBtn:function(o,e){if(core.is_mk)core.build({common:["ui","setUIBtn",o,e]});else if(o){var i;i=e?{callback:core.createCallback("init",e)}:{};var n={enable:{back:0,forward:0,refresh:0,share:o.action||0,scrollbar:1,ui_btn:1},ui_btn:{title:o.title,buttons:[{text:o.title,action:o.action||0,param:i}]}};core.build({common:["ui","init",n]})}else core.build({android:["ui","init",{enable:{back:0,forward:0,refresh:0,share:0,scrollbar:0,ui_btn:0},ui_btn:{buttons:[{text:"",action:0}]}}],ios:["ui","init",{enable:{back:0,forward:0,refresh:0,share:0,scrollbar:0,ui_btn:0}}]})},setUIGroup:function(o){var e=function(e){e&&void 0!==e.btn&&o.btns[e.btn].callback(e)};core.build({common:["ui","setUIGroup",o,e],need_mk:!0,version:{ios:"7.3.9",android:"7.3.9"}})},clearPageCover:function(o){core.is_mk&&"ios"==core.platform&&core.build({common:["ui","clearPageCover",{},o]})},getVisibility:function(o){core.build({common:["ui","getVisibility",{},o],version:{ios:"6.6.3",android:"6.6.1"}})},refresh:function(o){hasRefreshed=!0;var e,i=function(){hasRefreshed||core.ui.refreshEnd()},n=function(){hasRefreshed=!1,clearTimeout(e),e=setTimeout(i,16e3),setTimeout(function(){o&&o.call(null)},0)};core.build({common:["ui","refresh",{},n]})},refreshEnd:function(){hasRefreshed=!0,core.build({common:["ui","refreshEnd",{}]})},forbidLeftSlide:function(o){core.build({common:["ui","forbidLeftSlide",o]})},loadingView:function(o,e){core.build({common:["ui","loadingView",o,e],version:{ios:"8.19.7",android:"8.19.7"},need_mk:!0})},whiteScreenView:function(o,e){core.build({common:["ui","whiteScreenView",o,e],version:{ios:"8.19.7",android:"8.19.7"},need_mk:!0})}},core.share={showSharePanel:function(o,e){return void 0===e&&(e=function(){}),core.build({common:["share","showSharePanel",o,e]})},showPanel:function(o,e){void 0===e&&(e=function(){});var i=core.is_mk?"showPanel":"callShare";if(o){var n=["title","text","url","pic"],t=o.configs;if(t){if(t.momo_feed){var r=t.momo_feed;void 0===r.sdk&&!r.pic&&r.resource&&(r.sdk=1)}for(var c in t)n.forEach(function(e){!t[c].hasOwnProperty(e)&&o[e]&&(t[c][e]=o[e])});t.momo_contacts&&(!t.momo_friend&&(t.momo_friend=t.momo_contacts),!t.momo_discuss&&(t.momo_discuss=t.momo_contacts),!t.momo_group&&(t.momo_group=t.momo_contacts))}}core.build({common:["share",i,o,e]})},toApp:function(o,e){var i=core.is_mk?"toApp":"shareOne";"momo_feed"==o.app&&void 0===o.sdk&&!o.pic&&o.resource&&(o.sdk=1),core.build({common:["share",i,o,e]})},shareToIMWithParams:function(o,e){core.build({common:["share","shareToIMWithParams",o,e]})},displayGift:function(o,e){core.build({common:["ui","displayGift",o,e]})}},core.http={resetSession:function(o){core.build({common:["http","resetSession",{},o]})},request:function(o,e){o.method="post";var i;core.is_o_webview?i=!0:core.compare("7.0.9")>=0&&core.compare({ios:"7.4.1",android:"7.7"})<0&&(i=!0),i&&(o.encode=1);var n=function(o){if(i)try{var n=window.atob(o);n=escape(n),n=decodeURIComponent(n),o=JSON.parse(n)}catch(o){}else{if("string"==typeof o&&"android"==core.platform)try{var n=decodeURIComponent(o);o=JSON.parse(n)}catch(o){}if("string"==typeof o)try{var n=o.replace(/\\/g,"\\\\").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x1F\x7F-\x9F]/g,"");o=JSON.parse(n)}catch(o){}}e&&e.call(null,o)};core.build({common:["http","request",o,n]})}},core.storage={getItem:function(o,e){if(!core.is_mk){return void e(localStorage.getItem(o.key))}core.build({common:["storage","getItem",o,e]})},setItem:function(o){if(o.value+="",!core.is_mk)return void localStorage.setItem(o.key,o.value);if(o.value.length>102400&&core.compare(7.6)>=0)throw"setItem 字符超长";core.build({common:["storage","setItem",o]})},removeItem:function(o){if(!core.is_mk)return void localStorage.removeItem(o.path+o.key);core.build({common:["storage","removeItem",o]})},clearItem:function(o){if(!core.is_mk)return void localStorage.clear();var e="clearItem";"ios"==core.platform&&core.compare(6.8)<=0&&(e="clear"),core.build({common:["storage",e,o]})}},core.device={bindPhone:function(o,e){core.build({common:["device","bindPhone",{},e],need_mk:!0,version:{ios:"6.11.3",android:"7.0"}})},getStepCounter:function(o){core.build({common:["device","getStepCounter",{},o],need_mk:!0,version:{ios:"6.9.5",android:"6.9.5"}})},sendSMS:function(o){core.build({common:["device","sendSMS",o],need_mk:!0})},callPhone:function(o){core.build({common:["device","callPhone",o],need_mk:!0})},getSystemInfo:function(o,e){core.build({common:["device","getSystemInfo",e||{},o],need_mk:!0})},getClientInfo:function(o){core.build({common:["device","getClientInfo",{},o],need_mk:!0})},getScreenInfo:function(o){core.build({common:["device","getScreenInfo",{},o],version:"6.0"})},getBatteryInfo:function(o){var e=core.is_mk?"getBatteryInfo":"getBatteryStatus";core.build({common:["device",e,{},o],version:"6.0"})},getNetworkType:function(o){core.build({common:["device","getNetworkType",{},o],version:"6.0"})},startNetWorkListening:function(o){core.build({common:["device","startNetWorkListening",o]})},getAPIList:function(o){core.build({common:["device","getAPIList",{},o]})},getReferee:function(o,e){core.build({common:["device","getReferee",{},e],need_mk:!0,version:{ios:"7.1",android:"7.1"}})}},core.media={previewImage:function(o,e){core.build({common:["media","previewImage",o,e]})},readImages:function(o,e){if(!core.is_mk&&core.compare(6.3)<0){var i={id:"image",method:o.method,type:o.type},n=function(o,i,n,t){e.call(null,{status:0,images:[{data:i,size:n}]})};return core.build({common:["media","readImage",i,n]}),!1}core.build({common:["media","readImages",o,e]})},startAudio:function(o,e){core.build({common:["media","startAudio",o,e],version:"5.8"})},startVideo:function(o){core.build({common:["media","startVideo",o],version:"6.0"})},stopAudio:function(o){core.build({common:["media","stopAudio",o],version:"5.8"})},getImageData:function(o,e){core.build({common:["media","getImageData",o,e],need_mk:!0})},getImages:function(o,e){core.build({common:["media","getImages",o,e]})},screenShot:function(o,e){core.build({common:["media","screenShot",o,e]})},uploadImages:function(o,e){core.build({common:["media","uploadImages",o,e]})},saveBase64File:function(o,e){core.build({common:["media","saveBase64File",o,e]})},saveImagesToAlbum:function(o,e){core.build({common:["media","saveImagesToAlbum",o,e]})},shotVideo:function(o,e){core.build({common:["media","shotVideo",o,e]})},uploadFile:function(o,e){core.build({common:["media","uploadFile",o,e]})},recordSound:function(o,e){core.build({common:["media","recordSound",o,e]})},customRecord:function(o,e){core.build({common:["media","customRecord",o,e]})}},core.offline={update:function(o,e){core.build({common:["offline","update",o,e]})},batchUpdate:function(o,e){core.build({common:["offline","batchUpdate",o,e]})},checkUpdate:function(o,e){core.build({common:["offline","checkUpdate",o,e]})},isCached:function(o,e){core.build({common:["offline","isCached",o,e]})},clearCache:function(o){core.build({common:["offline","clearCache",{},o]})},removeCache:function(o,e){core.build({common:["offline","removeCache",o,e]})},getVersion:function(o,e){core.build({common:["offline","getVersion",o,e]})},isResourceOfflined:function(o,e){core.build({common:["offline","isResourceOfflined",o,e]})},sendOfflineRequest:function(o,e){core.build({common:["offline","sendOfflineRequest",o,e]})}},core.pay={cashDesk:function(o,e){core.build({common:["pay","cashDesk",o,e],version:{ios:"6.11.3",android:"7.0"}})},cashKey:function(o,e){core.build({common:["pay","cashKey",o,e],version:{ios:"6.11.3",android:"7.0"}})},doAlipay:function(o,e){core.build({common:["pay","doAlipay",o,e]})},bindAlipay:function(o,e){core.build({common:["pay","bindAlipay",o,e],need_mk:!0,version:{ios:"6.11.3",android:"7.0"}})},doWXpay:function(o,e){core.build({common:["pay","doWXpay",o,e],version:{ios:"6.7",android:"6.8"}})},sendPayResult:function(o){core.build({common:["pay","sendPayResult",o],version:{ios:"6.9",android:"6.9"}})},doWXwithhold:function(o){core.build({common:["pay","doWXwithhold",o],version:{ios:"7.7",android:"7.7"}})},doAliwithhold:function(o){core.build({common:["pay","doAliwithhold",o],version:{ios:"7.7",android:"7.7"}})},alipayBindingConfirm:function(o){core.build({common:["pay","alipayBindingConfirm",o]})}},core.sensor={getLocation:function(o){var e=function(e){"ios"==core.platform&&(e.latitude=e.lat,e.longitude=e.lng,delete e.lat,delete e.lng),o.call(null,e)};core.build({common:["sensor","getLocation",{},e]})},openLocation:function(o,e){core.build({common:["sensor","openLocation",o,e]})},viewLocation:function(o){core.build({common:["sensor","viewLocation",o]})},vibrate:function(o){core.build({common:["sensor","vibrate",o]})}},core.action={setLiveBtn:function(o,e){core.build({common:["action","setLiveBtn",o,e],version:{ios:"7.2.1",android:"7.2.1"}})},getUserPlace:function(o,e){core.build({common:["action","getUserPlace",o,e],version:{ios:"7.2",android:"7.2"}})},getLoginStatus:function(o){core.build({common:["action","getLoginStatus",{},o],version:{ios:"6.9.5",android:"6.9.5"}})},circlePublish:function(o,e){core.build({common:["action","circlePublish",o,e]})},commentKeyboard:function(o,e){core.build({common:["action","commentKeyboard",o,e]})},gotoPage:function(o,e){core.compare("7.0")<0&&"goto_select_all"==o.type&&(o.type="goto_select_contacts"),console.log(o),core.build({common:["action","gotoPage",o,e]})},setChatBubble:function(o,e){var i,n;core.is_mk?(i="setChatBubble",n=o):(i="doAction",n={type:"customBubble",param:o}),core.build({common:["action",i,n,e]})},setProfileCover:function(o,e){var i,n;core.is_mk?(i="setProfileCover",n=o):(i="doAction",n={type:"setProfileCover",param:o}),core.build({common:["action",i,n,e]})},SVIPGroupUpdgrade:function(o,e){var i,n;core.is_mk?(i="SVIPGroupUpdgrade",n=o):(i="doAction",n={type:"SVIPGroupUpdgrade",param:o}),core.build({common:["action",i,n,e]})},verifyLogin:function(o){var e,i;core.is_mk?(e="verifyLogin",i={}):(e="doAction",i={type:"verifyLogin",param:{}}),core.build({common:["action",e,i,o]})},reportSpam:function(o,e){var i,n;core.is_mk?(i="reportSpam",n=o):(i="doAction",n={type:"reportSpam",param:o}),core.build({common:["action",i,n,e]})},modifyGroupPartyFinish:function(o,e){var i,n;core.is_mk?(i="modifyGroupPartyFinish",n=o):(i="doAction",n={type:"modifyGroupPartyFinish",param:o}),core.build({common:["action",i,n,e]})},refreshUserProfile:function(o,e){core.is_mk?"refreshUserProfile":"doAction",core.build({common:["action","refreshUserProfile",o,e]})},refreshGroupProfile:function(o,e){core.build({common:["action","refreshGroupProfile",o,e],need_mk:!0})},getUserInfo:function(o){core.build({common:["action","getUserInfo",{},o]})},checkContacts:function(o,e){"object"==typeof o.data&&(o.data=JSON.stringify(o.data)),core.build({common:["action","checkContacts",o,e],need_mk:!0})},getChatList:function(){var o,e;1==arguments.length?(e={count:10},o=arguments[0]):(e=arguments[0],o=arguments[1]),core.build({common:["action","getChatList",e,o]})},liveIdentify:function(){core.build({common:["action","liveIdentify",{}]})},doAuthenticate:function(o){core.build({common:["action","doAuthenticate",o]})},recordPerf:function(o){core.build({common:["action","recordPerf",o]})},refreshGiftBoard:function(o,e){core.build({common:["action","refreshGiftBoard",o,e],version:{ios:"8.7.2",android:"8.7.2"},need_mk:!0})},getZhimaMetaInfo:function(o){core.build({common:["action","getZhimaMetaInfo",{},o]})},analyzeRecord:function(o,e){if("pv"==o.event_type&&!o.page_view_id){if(!core._ctxId||-1==core._ctxId){var i=function(){return(65536*(1+Math.random())|0).toString(16).substring(1)};core._ctxId="mk-"+(i()+i())+"-"+i()+"-"+i()+"-"+i()+"-"+i()+i()+i()}o.page_view_id=core._ctxId}core.build({common:["action","analyzeRecord",o,e],need_mk:!0})},reportError:function(o,e){core.build({common:["action","reportError",o,e],version:{ios:"8.19.7",android:"8.19.7"},need_mk:!0})},getBusinessNotifySwitch:function(o,e){core.build({common:["action","getBusinessNotifySwitch",o,e],need_mk:!0})},openBusinessNotifySwitch:function(o,e){core.build({common:["action","openBusinessNotifySwitch",o,e],need_mk:!0})},closeBusinessNotifySwitch:function(o,e){core.build({common:["action","closeBusinessNotifySwitch",o,e],need_mk:!0})}},core.app={downloadApp:function(o,e){core.compare(6.3)>=0&&(e=null),core.build({android:["app","downloadApp",o,e]})},getDownloadList:function(o){core.build({android:["app","getDownloadList",{},o]})},isInstalled:function(o,e){var i=core.is_mk?"isInstalled":"checkGames",n=initAppObj(o);core.build({common:["app",i,n,e]})},installApps:function(o,e){var i;i=core.is_mk?e:function(o){e.call(null,{games:JSON.parse(o)})};var n=core.is_mk?"installApps":"installGames",t=initAppObj(o);core.build({common:["app",n,t,i]})},launchApp:function(o){core.build({common:["app","launchApp",{schema:o.schema,url:o["url_"+core.platform]||""}]})},checkPermission:function(o,e){core.build({android:["app","checkPermission",o,e]})}},core.view={prepare:function(o,e){core.build({common:["view","prepare",o,e]})},destroy:function(o,e){core.build({common:["view","destroy",o,e]})}},core.agora={joinChannel:function(o){core.build({common:["agora","joinChannel",o]})},setAgoraAudio:function(o){setTimeout(function(){core.build({common:["agora","setAgoraAudio",o]})},0)},leavelChannel:function(o){core.build({common:["agora","leavelChannel",o]})},checkResVersion:function(o){core.build({common:["agora","checkResVersion",o]})},playSound:function(o){setTimeout(function(){core.build({common:["agora","playSound",o]})},0)},stopSound:function(o){setTimeout(function(){core.build({common:["agora","stopSound",o]})},0)},renewChanelKey:function(o){core.build({common:["agora","renewChanelKey",o]})}},core.rtc={joinChannel:function(o,e){core.build({common:["rtc","joinChannel",o,e]})},leaveChannel:function(o,e){core.build({common:["rtc","leaveChannel",o,e]})},audioMuteLocalStream:function(o,e){core.build({common:["rtc","audioMuteLocalStream",o,e]})},audioPlayEffect:function(o){core.build({common:["rtc","audioPlayEffect",o]})},audioStopEffect:function(o){core.build({common:["rtc","audioStopEffect",o]})},audioPlayFile:function(o){core.build({common:["rtc","audioPlayFile",o]})},audioStopFile:function(o){core.build({common:["rtc","audioStopFile",o]})},audioResumeFile:function(o){core.build({common:["rtc","audioResumeFile",{}]})},audioPauseFile:function(o){core.build({common:["rtc","audioPauseFile",{}]})},changeRole:function(o,e){core.build({common:["rtc","changeRole",o,e]})},setPlayingFileVolume:function(o){core.build({common:["rtc","setPlayingFileVolume",o]})},isOnRtcService:function(o,e){core.build({common:["rtc","isOnRtcService",o,e]})},audioMuteRemoteStream:function(o,e){core.build({common:["rtc","audioMuteRemoteStream",o,e]})},renewChannelKey:function(o,e){core.build({common:["rtc","renewChannelKey",o,e]})}},core.globalEvent={addEventListener:function(o,e){/^bn/.test(o.name)||o.target||(o.target="*"),core.build({common:["globalEvent","addEventListener",o,e]})},removeEventListener:function(o){/^bn/.test(o.name)||o.target||(o.target="*"),core.build({common:["globalEvent","removeEventListener",o]})},postEvent:function(o){/^bn/.test(o.name)||o.target||(o.target="*"),core.build({common:["globalEvent","postEvent",o]})}},core.websocket={connect:function(o,e){core.build({common:["websocket","connect",o,e]})},disconnect:function(o,e){core.build({common:["websocket","disconnect",o,e]})},send:function(o,e){core.build({common:["websocket","send",o,e]})}},window&&(window.mm=core);var bridge_all=core;

////////////////////////////
//mock.js
"use strict";var _isSupport7_1=mm.compare("7.0.9")>0;var _analy={firstTime:0,lastTime:0,sendCount:0,count:0,isLoaded:false,cache:false};var _allAnaly={start:{},data:{},net:"none"};var deviceBack=function(res){_allAnaly.net=res.network_type};if(mm.is_mk){mm.invoke("device","getNetworkType",{},deviceBack)}else{mm.invoke("getNetworkType",{},deviceBack)}function extend(to,_from){for(var key in _from){to[key]=_from[key]}return to}function addAjaxParam(key,value){if(typeof value=="function"){value=value()}if(value==null){value=""}return encodeURIComponent(key)+"="+encodeURIComponent(value)}function getAjaxData(params,obj,scope,isNative){var value,type,array=Array.isArray(obj)||obj instanceof Array,hash=Object.prototype.toString.call(obj)==="[object Object]"&&Object.getPrototypeOf(obj)==Object.prototype;for(var key in obj){value=obj[key];type=typeof value;if(scope){key=scope+"["+key+"]"}if(!scope&&array){if(isNative){params[key]=value}else{params.push(addAjaxParam(key,value))}}else{if(type=="object"){getAjaxData(params,value,key,isNative)}else{if(isNative){params[key]=value}else{params.push(addAjaxParam(key,value))}}}}}function localAjax(ajaxOpt){var xhr=new window.XMLHttpRequest(),data=ajaxOpt.data||"",url=ajaxOpt.url,ajaxError=ajaxOpt.error,ajaxSuccess=ajaxOpt.success;xhr.onreadystatechange=function(){if(xhr.readyState==4){var result,error=false;if((xhr.status>=200&&xhr.status<300)||xhr.status==304||(xhr.status==0&&location.protocol=="file:")){result=xhr.responseText;try{result=/^\s*$/.test(result)?null:JSON.parse(result)}catch(e){error=e}if(error){ajaxError(error,"parsererror",xhr)}else{ajaxSuccess(result,xhr)}}else{ajaxError(xhr.statusText||null,xhr.status?"error":"abort",xhr)}}};xhr.open("POST",url,true);xhr.setRequestHeader("Accept","application/json");xhr.setRequestHeader("Content-Type","application/x-www-form-urlencoded");xhr.setRequestHeader("X-Requested-With","XMLHttpRequest");xhr.withCredentials=true;if(data&&typeof data!="string"){var params=[];getAjaxData(params,data);data=params.join("&").replace(/%20/g,"+")}xhr.send(data)}window.addEventListener("load",function(){_analy.isLoaded=true;CommonSendAjaxMMA(true)},false);function CommonSendAjaxMMA(isLoadEvent,options){if(!_analy){return}if(!isLoadEvent&&options.analy){_analy.count++;_analy.lastTime=Date.now()}if(_analy.isLoaded&&_analy.sendCount<=_analy.count){if(_analy.firstTime){if(typeof MMA!="undefined"){delete _analy.sendCount;delete _analy.isLoaded;MMA.addInit({ajax:_analy});if(MMA.sendLog){MMA.sendLog(_allAnaly.data)}_analy=null;_allAnaly.data=null}}else{_analy=null}}}function sendMMA(url,ext,cxp){if(typeof MMA=="undefined"){return}MMA.sendEvent(null,{api:1,lucky:1,et:4,cu:url,cxp:cxp||"ajax_error",ext:ext})}function getRequest(options,storageObj){this.options=options;this.storageObj=storageObj;this.resp=null;if(_analy){if(!_analy.firstTime){_analy.firstTime=Date.now()}if(options.analy){_analy.sendCount++}}_allAnaly.start[options.url+storageObj.cacheKey]=Date.now();if(options.useCache){this.getLocalStorage.apply(this,arguments)}else{this.sendRequest.apply(this,arguments)}}var getSession=(function(){var isSet=false,sessionStatus=null,requestArr=[],errorArr=[],isLowAndroid=mm.platform=="android"&&mm.build_version<1650;return function(resp,options){var canReload=!isLowAndroid&&options.autoReload;if(sessionStatus==0){if(requestArr.indexOf(this)==-1&&canReload){this.sendRequest();return true}return false}else{if(sessionStatus==1){return false}}requestArr.push(this);errorArr.push(resp);if(!isSet){isSet=true;mm.invoke("http","resetSession",{},function(sess){if(canReload&&sess.status==0){sessionStatus=0;for(var i=0;i<requestArr.length;i++){requestArr[i].sendRequest()}}if(!canReload||sess.status!=0){sessionStatus=1;for(var i=0;i<requestArr.length;i++){requestArr[i].onlineSuc(errorArr[i])}}})}return true}})();getRequest.prototype={getLocalStorage:function(){var _self=this;var options=this.options;var storageObj=this.storageObj;_self.sendRequest(arguments);var resp=localStorage.getItem(storageObj.path+storageObj.key);if(!resp){return}var dt;if(_isSupport7_1){try{var dt=window.atob(resp);dt=escape(dt);dt=decodeURIComponent(dt);options._mock.origin=dt;dt=JSON.parse(dt)}catch(err){dt=_self.changeCode(resp)}}else{dt=_self.changeCode(resp)}options._mock.originObj=dt;options.success.call(options,dt);if(_analy){_analy.cache=true}},changeCode:function(resp){var dt;try{dt=JSON.parse(resp)}catch(err){try{var codeInfo=resp.replace(/\\/g,"\\\\").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x1F\x7F-\x9F]/g,"");dt=JSON.parse(codeInfo)}catch(err){dt=resp}}this.options._mock.origin=resp;return dt},sendRequest:function(){var _self=this;var options=this.options;var sendObj={url:options.url,data:options.data,dataType:"json",type:"POST"};if(mm.is_mk){if(mm.platform=="android"){var params={};getAjaxData(params,sendObj.data,null,true);sendObj.data=params}mm.http.request(sendObj,function(resp){if(resp){if(typeof resp=="object"){if(resp.ec&&(resp.ec<0||resp.ec==1)){resp.em="网络好像有点问题";
options.success&&options.success.call(options,resp);if(options._mock.originObj&&options.finish){options.finish.call(options,options._mock.originObj)}sendMMA(options.url,resp);return}if(/^\d\d\d401$/.test(resp.ec)&&getSession.call(_self,resp,options)){return}}else{sendMMA(options.url,resp,"ajax_datatype")}}_self.onlineSuc(resp)})}else{try{sendObj.success=function(resp){_self.onlineSuc.call(_self,resp)};sendObj.error=function(resp,textState){if(resp){_self.onlineErr({ready:resp.readyState,status:resp.status,text:textState},resp)}return};localAjax(sendObj)}catch(err){console.warn("mock warn: $.ajax error")}}},onlineSuc:function(resp){var _self=this;var options=this.options;var storageObj=this.storageObj;if(options.useCache&&!!resp){var is_obj=typeof resp=="object";var dataStr=is_obj?JSON.stringify(resp):resp;if(_isSupport7_1){var dataStr=encodeURIComponent(dataStr);dataStr=unescape(dataStr);dataStr=window.btoa(dataStr)}if(!!options._mock.origin&&options._mock.origin==dataStr&&options.finish){options.finish.call(options,resp);return false}if(!is_obj||is_obj&&(resp.ec==200||resp.ec==0)){extend(storageObj,{value:dataStr});localStorage.setItem(storageObj.path+storageObj.key,dataStr)}}options.end=true;var now=Date.now();var send={};send[now]={type:"ajax",data:{net:_allAnaly.net,uri:options.url.replace(/\?.*/,""),wt:now-_allAnaly.start[options.url+storageObj.cacheKey],origin:location.href.replace(/\?.*/,""),bid:mm.query._bid?mm.query._bid[0]:""}};if(_allAnaly.data){_allAnaly.data[now]=send[now]}else{if(MMA.sendLog){MMA.sendLog(send)}}if(options._mock.origin){options.update.call(options,resp)}else{options.success.call(options,resp)}if(options.finish){options.finish.call(options,resp)}},onlineErr:function(err,resp){var options=this.options;if(options.error){options.error.call(options,resp)}sendMMA(options.url,err)}};var mk={version:"4.0.12",ajax:function(opt){var options=extend({},opt);var _success=options.success,_update=options.update,_error=options.error,_finish=options.finish,_progress=options.progress,cacheKey=options.cacheKey;options._mock={};if(typeof options.autoReload=="undefined"){options.autoReload=true}if(opt.host){if(mm.is_mk){options.url=opt.host+options.url}else{if(opt.host.indexOf("mk.immomo.com")>-1){if(mm.is_webview){mk.showError();sendMMA(opt.host+options.url,"","mk_url_error");return}options.url="/mk"+options.url}else{options.url=opt.host+options.url}}}else{if(mm.is_mk&&!/^http/.test(options.url)){options.url=mm.protocol+"//"+mm.host+options.url}}if(!cacheKey){var opt_data=options.url;if(options.data){opt_data+=options.url.indexOf("?")>-1?"&":"?";var data_arr=[];for(var k in options.data){data_arr.push(k+"="+options.data[k])}opt_data+=data_arr.join("&")}cacheKey=encodeURI(opt_data)}var storageObj={path:options.cachePath||"",key:cacheKey};options.success=function(data,status,xhr){CommonSendAjaxMMA(false,options);_success&&_success.apply(options,arguments);_progress&&_progress.apply(options,arguments)};options.update=function(data,status,xhr){_update&&_update.apply(options,arguments);_progress&&_progress.apply(options,arguments)};options.error=function(xhr,errorType,error){CommonSendAjaxMMA(false,options);_error&&_error.apply(options,arguments)};new getRequest(options,storageObj)},showError:function(errorText){errorText=errorText||"网络好像有点问题";if(typeof mm!="undefined"){mm.invoke("ui","showMessage",{status:2,message:errorText})}},post:function(url,data,success){if(typeof data=="function"){success=data,data=undefined}return mk.ajax({url:url,data:data,success:success})}};window.mk=mk;
})();